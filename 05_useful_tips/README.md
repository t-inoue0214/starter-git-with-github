# 05. 現場で役立つ便利機能：Stash, Ignore, Tag

ここでは、毎日の開発をよりスムーズかつ安全に進めるための、3つの重要な機能を紹介します。

## 1. ゴミを無視する `.gitignore`

Gitは「全てのファイル」を管理しようとしますが、管理したくないファイルもあります。

- **OSの自動生成ファイル:** `.DS_Store` (Mac), `Thumbs.db` (Windows)
- **ビルド生成物:** `node_modules/`, `target/`, `bin/`
- **機密情報:** `password.txt`, `.env` (APIキーなど)

これらを誤ってコミットすると、以下のようなトラブルにつながります。

- リポジトリが重くなる
- **セキュリティ事故**
- コード差分が多くなり、コミット漏れが増える

### gitignoreの設定方法

リポジトリのルート（一番上）に `.gitignore` という名前のファイルを作ります。
中身に「無視したいファイル名やフォルダ名」を記述します。

```text
# .gitignore の記述例

# 秘密のファイル（絶対コミットしない！）
secret_config.json
*.key

# 依存ライブラリ（重いので除外）
node_modules/
vendor/

# OSのゴミ
.DS_Store
```

**ポイント:**

`.gitignore`に書いておけば、`git add .` をしても、それらのファイルは無視（除外）されます。 現場のリポジトリには必ずこのファイルがあります。

**「何が除外されているか」** を最初に確認する癖をつけましょう。

## 2. 作業の一時退避 `git stash`

開発現場でよくあるシチュエーションです。

- 「機能Aを開発中（書きかけ）。まだエラーが出るからコミットはできない...」 **リーダー「緊急のバグ修正頼む！すぐに別のブランチで作業して！」**

書きかけのファイルをそのままにしてブランチを切り替えると、エラーが出たり、変更が混ざってしまいます。

そんな時に使うのが 「**一時退避（Stash）**」 です。

1. 変更を一時的に隠す

    ```bash
    # メッセージ付きで隠す（推奨）
    git stash save "機能Aの作業途中"
    ```

    これで、変更していたファイルが元に戻り、作業ディレクトリが綺麗になります。安心してブランチを切り替えられます。

1. 退避したリストを見る

    ```bash
    git stash list
    # stash@{0}: On main: 機能Aの作業途中 ...
    ```

1. 変更を戻す（復元する）

    緊急対応が終わって元のブランチに戻ってきたら、隠していた作業を取り出します。

    ```bash
    # 最新の退避内容を戻して、リストから消す
    git stash pop
    ```

ただし、いくらでも保存しておける魔法の方法でありません。

再び戻すときにスタッシュした内容と現在の編集中ファイルがあれば競合を引き起こします。

スタッシュする際は、スタッシュしたい最小限のファイルをスタッシュしてください。

また、使わなくなったらすぐに削除することを推奨します。

## 3. リリースの目印 `git tag`

コミットID（a1b2c...）は覚えにくいので、特定のコミットに「v1.0.0」のような分かりやすい名札をつける機能です。

```bash
# タグをつける
git tag v1.0.0

# タグをサーバーに送る（通常はタグは送られません）
git push origin v1.0.0
```

**注意点：** タグは自動でPushされない

通常の git push ではタグはサーバーに送られません。明示的に送る必要があります。

```bash
git push origin v1.0.0
```
